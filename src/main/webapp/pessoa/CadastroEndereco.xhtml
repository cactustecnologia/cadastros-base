<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">


<p:commandButton value="Adiciona Endereço" style="margi-top: 20px"
	update="inclusaoEnderecoPanel"
	onclick="inclusaoEnderecoDialog.show(); return false;" />

<p:dataTable id="pessoaEnderecoTable"
	value="#{pessoaBean.pessoa.enderecos}" var="endereco" paginator="true"
	rows="20" emptyMessage="Nenhum endereço adicionado!"
	paginatorAlwaysVisible="false" paginatorPosition="bottom"
	style="margin-top:5px;">

	<p:column headerText="Logradouro">
		<h:outputText value="#{endereco.logradouro}" />
	</p:column>
	<p:column headerText="Número">
		<h:outputText value="#{endereco.numero}" />
	</p:column>
	<p:column headerText="Complemento">
		<h:outputText value="#{endereco.complemento}" />
	</p:column>
	<p:column headerText="Bairro">
		<h:outputText value="#{endereco.bairro}" />
	</p:column>
	<p:column headerText="Cidade">
		<h:outputText value="#{endereco.cidade}" />
	</p:column>
	<p:column headerText="CEP">
		<h:outputText value="#{endereco.cep}" />
	</p:column>
	<p:column headerText="Município">
		<h:outputText value="#{endereco.municipioIbge}" />
	</p:column>
	<p:column headerText="UF">
		<h:outputText value="#{endereco.uf}" />
	</p:column>
	<p:column headerText="Fone">
		<h:outputText value="#{endereco.fone}" />
	</p:column>
	<p:column headerText="Fax">
		<h:outputText value="#{endereco.fax}" />
	</p:column>
	<p:column style="width: 100px; text-align: center">
		<p:commandButton icon="ui-icon-pencil" title="Editar">
		</p:commandButton>
		<p:commandButton icon="ui-icon-trash">
		</p:commandButton>
	</p:column>
</p:dataTable>


<p:dialog header="Inclusão de Endereço" id="dialogEndereco"
	widgetVar="inclusaoEnderecoDialog" modal="true" resizable="false">
	<p:ajax event="close"
		update="inclusaoEnderecoPanel msgEndereco dialogEndereco"
		listener="#{pessoaBean.handleClose}" />
	<h:panelGroup id="inclusaoEnderecoPanel">
		<p:messages id="msgEndereco" closable="true" />

		<h:panelGrid columns="4">
			<p:outputLabel for="logradouroEndereco" value="Logradouro:" />
			<p:inputText id="logradouroEndereco" size="30"
				value="#{pessoaBean.endereco.logradouro}" required="true" />


			<p:outputLabel for="numeroEndereco" value="Número:" />
			<p:inputText id="numeroEndereco" size="10"
				value="#{pessoaBean.endereco.numero}" required="true" />

			<p:outputLabel for="complementoEndereco" value="Complemento:" />
			<p:inputText id="complementoEndereco" size="30"
				value="#{pessoaBean.endereco.complemento}" />

			<p:outputLabel for="bairroEndereco" value="Bairro:" />
			<p:inputText id="bairroEndereco" size="30"
				value="#{pessoaBean.endereco.bairro}" required="true" />

			<p:outputLabel for="cepEndereco" value="CEP:" />
			<p:inputMask mask="99.999-999" id="cepEndereco" size="10"
				value="#{pessoaBean.endereco.cep}" required="true" />

			<p:outputLabel for="municipioEndereco" value="Município(IBGE):" />
			<p:inputText id="municipioEndereco" size="10"
				value="#{pessoaBean.endereco.municipioIbge}" />


			<p:outputLabel for="ufEndereco" value="UF:" />
			<p:selectOneMenu id="ufEndereco" value="#{pessoaBean.endereco.uf}"
				required="true" requiredMessage="Campo obrigatório"
				converter="converterUf">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItems value="#{pessoaBean.ufs}" var="ufEndereco"
					itemValue="#{ufEndereco}" itemLabel="#{ufEndereco.nome}" />
				<p:ajax render="cidadeEndereco" event="change"
					listener="#{pessoaBean.listaMunicipios}" />
			</p:selectOneMenu>
			

			<p:outputLabel for="cidadeEndereco" value="Cidade:" />
			<p:selectOneMenu id="cidadeEndereco" value="#{pessoaBean.endereco.municipioIbge}"
				required="true" requiredMessage="Campo obrigatório"
				converter="converterMunicipio">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItems value="#{pessoaBean.municipios}" var="cidadeEndereco" itemValue="#{cidadeEndereco}"
					itemLabel="#{cidadeEndereco.nome}" />
			</p:selectOneMenu>
			


			<p:outputLabel for="foneEndereco" value="Fone:" />
			<p:inputMask mask="99 9999-9999" id="foneEndereco" size="10"
				value="#{pessoaBean.endereco.fone}" />

			<p:outputLabel for="faxEndereco" value="Fax:" />
			<p:inputMask mask="99 9999-9999" id="faxEndereco" size="10"
				value="#{pessoaBean.endereco.fax}" />

			<p:outputLabel for="principalEndereco" value="Principal:" />
			<p:selectOneMenu id="principalEndereco"
				value="#{pessoaBean.endereco.principal}" required="true">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItem itemLabel="Sim" itemValue="S" />
				<f:selectItem itemLabel="Não" itemValue="N" />
			</p:selectOneMenu>

			<p:outputLabel for="entregaEndereco" value="Entrega:" />
			<p:selectOneMenu id="entregaEndereco"
				value="#{pessoaBean.endereco.entrega}">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItem itemLabel="Sim" itemValue="S" />
				<f:selectItem itemLabel="Não" itemValue="N" />
			</p:selectOneMenu>

			<p:outputLabel for="cobrancaEndereco" value="Cobrança:" />
			<p:selectOneMenu id="cobrancaEndereco"
				value="#{pessoaBean.endereco.cobranca}">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItem itemLabel="Sim" itemValue="S" />
				<f:selectItem itemLabel="Não" itemValue="N" />
			</p:selectOneMenu>

			<p:outputLabel for="correspondenciaEndereco" value="Correspondência:" />
			<p:selectOneMenu id="correspondenciaEndereco"
				value="#{pessoaBean.endereco.correspondencia}">
				<f:selectItem itemLabel="Selecione" />
				<f:selectItem itemLabel="Sim" itemValue="S" />
				<f:selectItem itemLabel="Não" itemValue="N" />
			</p:selectOneMenu>

			<p:commandButton value="Incluir"
				process="@this inclusaoEnderecoPanel"
				action="#{pessoaBean.adicionaEndereco}"
				update="msgEndereco :frmPessoa:tabPessoa:pessoaEnderecoTable inclusaoEnderecoPanel"
				oncomplete="tratarInclusaoEndereco(args);" />
		</h:panelGrid>
	</h:panelGroup>
</p:dialog>

<script>
	function tratarInclusaoEndereco(args) {
		if (!args.validationFailed) {
			inclusaoEnderecoDialog.hide();
		}
	}
</script>
</html>